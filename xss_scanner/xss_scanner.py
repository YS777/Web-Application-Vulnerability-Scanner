import requests
from concurrent.futures import ThreadPoolExecutor

xss_payloads = [
    # Extended payloads list for various contexts
]

def check_payload(url, param, payload):
    try:
        response = requests.get(url, params={param: payload})
        # More sophisticated checks
        if payload in response.text:
            return f"Potential XSS vulnerability found with payload: {payload} in param: {param}"
        else:
            return f"Payload {payload} appears safe in param: {param}."
    except requests.exceptions.RequestException as e:
        return f"Error scanning {url} with payload {payload} in param {param}: {e}"

def scan_xss(url, params):
    print(f"Scanning {url} for XSS vulnerabilities...")

    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(check_payload, url, param, payload) 
                   for param in params 
                   for payload in xss_payloads]
        
        for future in futures:
            print(future.result())

# Example usage
if __name__ == "__main__":
    target_url = "http://example.com"
    # Example params to test
    params = ['input', 'search', 'id']
    scan_xss(target_url, params)
