import requests
from bs4 import BeautifulSoup

# Common names for CSRF tokens
csrf_token_names = ['csrf_token', 'csrf', 'token', 'xsrf_token']

def scan_csrf(url):
    print(f"Scanning {url} for CSRF vulnerabilities...")
    try:
        response = requests.get(url)
        response.raise_for_status()  # Ensure we catch HTTP errors
        soup = BeautifulSoup(response.text, 'html.parser')
        forms = soup.find_all('form')

        if not forms:
            print("No forms found on this page.")
            return

        for form in forms:
            inputs = form.find_all('input')
            found_token = False
            for input_element in inputs:
                if input_element.get('name') in csrf_token_names:
                    found_token = True
                    break
            
            if found_token:
                print("CSRF token found, form appears safe.")
            else:
                print(f"Potential CSRF vulnerability found in form: {form}")

    except requests.exceptions.RequestException as e:
        print(f"Error scanning {url} for CSRF: {e}")

# Example usage
if __name__ == "__main__":
    target_url = "http://example.com"
    scan_csrf(target_url)
